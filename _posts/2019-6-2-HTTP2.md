---
layout: post
title: HTTP(缓存、重定向问题)
categories: HTTP
tegs:
- 缓存
- 重定向
date: 2019-6-2
---

## 关于缓存问题

> from memory cache 和 from disk cache

1. `from memory cache` 从内存中拉取的缓存
2. `from disk cache` 从磁盘上拉取的缓存

在资源拉取过后，这里还是针对的Chrome进行解释，浏览器在拉取资源后，会对资源进行磁盘和内存进行缓存，而`css文件`会缓存到磁盘上，`html.js,img等文件`都会在内存和磁盘进行缓存，当刷新页面时，除了在特定的资源中返回头中写入`cache-contorl: no-cache`或者`no-store`的情况下都会直接从缓存中拉取资源，会在size中显示`from memory cache`，而css文件则显示`from disk cache`, 但是 `no-cache`验证没有过期，则还会返回304进行读取缓存，只是到原服务器进行了一个验证。

<br>

> meta http-equiv="Cache-Control" content="no-cache" 设置的备要性

此时前端和后端同学前后端已经联调好了，发到测试环境，让测试同志进行测试。

`测试说`：你页面中一个字写错了，改一下，重新发包我再来测，测试关闭浏览器，刷了一会抖音

`前端一顿操作后`。。。。这一顿操作猛如虎

`前端说`：好了，你测吧。我发上去了，此时也关闭了浏览器，心里想测试要测试默默JJ的，我先刷一会抖音。

`测试一顿操作后`。。。打开浏览器，把地址输入了进去，回车后。。。

`测试说`： 你到底改没改啊，怎么没有效果。

前端此时也打开浏览器，输入地址，一看，wc什么情况。开始怀疑人生了。。。我明明改了。怎么没效果。然后又是一顿猛如虎的打开文件看了看，又重新发包

`问题总结`：

根本原因，进行一个分析，正是因为缓存问题而导致，浏览器对html页会进行一个自动缓存，但是正常刷新情况下，如果用nginx做一个静态资源的情况下，都会进行一个304的重新向服端进行一个资源是否改动的验证，如果没有改动则进行一个304的缓存利用

当关闭浏览器进程的时候，缓存在内存中的资源会随着浏览器的闭毕一起清除，当再次打开浏览器的时候会从磁盘上读取缓存，这时候如果没有设置`meta http-equiv="Cache-Control" content="no-cache"`，当打开浏览器再次仿问的时候，html页面初次会进行浏览器的磁盘上读取就是from disk cache,那此时肯定用的还是原本旧的资源，这就是问题产生的根本，所以在加入每次都从原服务器验证资源，在打开浏览器的时候就不会出来资源没有及时更新的问题。

<br><br>

## 关于重定向的一些坑

### 301适合永久重定向

301比较常用的场景是使用域名跳转。比如，我们访问 http://www.baidu.com 会跳转到 https://www.baidu.com，发送请求之后，就会返回301状态码，然后返回一个location，提示新的地址，浏览器就会拿着这个新的地址去访问。

### 302用来做临时跳转

302和301的区别则是设置了302如果再次访问则是从服务端再次拉取资源，然后进行重定向。301则是如果有缓存文件，则直接读缓存文件上响应头上的重定向位置，如果原服务端重定向的位置有变化，则只能通过用户清除缓存进行重新拉取新资源进行再次重定向，所以301的使用需要严谨。

<br><br>

[引用链接](https://juejin.im/post/5b34e6ba51882574d20bbdd4)